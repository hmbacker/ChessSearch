(this.webpackJsonpproject3=this.webpackJsonpproject3||[]).push([[0],{143:function(e,t,a){e.exports=a.p+"static/media/chess_pieces.2c242c73.svg"},145:function(e,t,a){e.exports=a.p+"static/media/loading.33aa6267.svg"},159:function(e,t,a){e.exports=a(278)},168:function(e,t,a){},169:function(e,t,a){},170:function(e,t,a){},171:function(e,t,a){},172:function(e,t,a){},275:function(e,t,a){},276:function(e,t,a){},277:function(e,t,a){},278:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(70),l=a.n(c),i=a(21),s=(a(168),a(46)),m="FETCH_SEARCH_RESULTS",o="FETCH_GAME",u="FETCH_MORE_SEARCH_RESULTS",d="FETCH_COMMENTS",h="POST_COMMENT",g="REQUEST",p="FAILURE",f="SUCCESS";function b(e){return{type:m,paramObject:e,status:g}}function E(e){return"?playerw="+e.playerw+"&playerb="+e.playerb+"&ignorecolors="+e.ignorecolors+"&winner="+e.winner+"&datemin="+e.datemin+"&datemax="+e.datemax+"&ratingmin="+e.ratingmin+"&ratingmax="+e.ratingmax+"&eco="+e.eco+"&turnmin="+e.turnmin+"&turnmax="+e.turnmax+"&orderby="+e.orderby+"&descending="+e.descending+"&offset="+e.offset+"&limit="+e.limit}function y(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];fetch("http://it2810-55.idi.ntnu.no:3001/prosjekt3/api/games"+e).then((function(e){if(e.ok)return e.json();throw new Error(e.statusText)})).then((function(e){t?x.dispatch(function(e){return{type:u,status:f,results:e}}(e)):x.dispatch({type:m,status:f,results:e})})).catch((function(e){t?x.dispatch(function(e){return{type:u,status:p,error:e}}(e)):x.dispatch(function(e){return{type:m,status:p,error:e}}(e))}))}var v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{results:[],isFetching:!1,mostRecentCall:null},t=arguments.length>1?arguments[1]:void 0;if(t.type===m){if(t.status===g){if(!e.isFetching)return y(E(t.paramObject)),Object.assign({},e,{isFetching:!0,fetchParamObject:t.paramObject,mostRecentParamObject:t.paramObject,error:""});if(t.paramObject!==e.fetchParamObject)return Object.assign({},e,{mostRecentParamObject:t.paramObject})}else if(t.status===p){if(e.isFetching)return Object.assign({},e,{isFetching:!1,fetchParamObject:null,error:t.error})}else if(t.status===f&&e.isFetching)return E(e.mostRecentParamObject)===E(e.fetchParamObject)?Object.assign({},e,{results:t.results[0],resultsParamObject:e.fetchParamObject,fetchParamObject:null,isFetching:!1,resultsComplete:!1,error:"",graphData:t.results[1]}):(y(E(e.mostRecentParamObject)),Object.assign({},e,{fetchParamObject:e.mostRecentParamObject}))}else if(t.type===u)if(t.status===g){if(!e.isFetching&&e.resultsParamObject&&!e.resultsComplete){var a=Object.assign({},e.resultsParamObject);a.offset+=a.limit,a.limit=t.limit;var n=E(a);return y(n,!0),Object.assign({},e,{isFetching:!0,fetchParamObject:a,mostRecentParamObject:a,mostRecentQuery:n,error:""})}}else if(t.status===p){if(e.isFetching)return Object.assign({},e,{isFetching:!1,fetchParamObject:null,error:t.error})}else if(t.status===f&&e.isFetching&&E(e.mostRecentParamObject)===E(e.fetchParamObject))return Object.assign({},e,{results:e.results.concat(t.results[0]),resultsParamObject:e.fetchParamObject,fetchParamObject:null,isFetching:!1,resultsComplete:t.results[0]<e.fetchParamObject.limit,error:""});return e};var w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1},t=arguments.length>1?arguments[1]:void 0;if(t.type===o)if(t.status===g){if(!e.isFetching)return fetch("http://it2810-55.idi.ntnu.no:3001/prosjekt3/api/games/"+t.id).then((function(e){if(e.ok)return e.json();throw new Error(e.statusText)})).then((function(e){try{x.dispatch((t=e[0],{type:o,status:f,data:t}))}catch(a){}var t})).catch((function(e){x.dispatch(function(e){return{type:o,status:p,error:e}}(e))})),Object.assign({},e,{isFetching:!0,id:t.id,error:""})}else if(t.status===p){if(e.isFetching)return Object.assign({},e,{isFetching:!1,id:null,error:t.error})}else if(t.status===f&&e.isFetching)return Object.assign({},e,{data:t.data,isFetching:!1,id:t.id,error:""});return e};function O(e){fetch("http://it2810-55.idi.ntnu.no:3001/prosjekt3/api/games/"+e+"/comments").then((function(e){if(e.ok)return e.json();throw new Error(e.statusText)})).then((function(e){x.dispatch({type:d,status:f,comments:e})})).catch((function(e){x.dispatch(function(e){return{type:d,status:p,error:e}}(e))}))}function j(e,t){fetch("http://it2810-55.idi.ntnu.no:3001/prosjekt3/api/games/"+e+"/create",{method:"POST",headers:new Headers({"Content-Type":"application/json"}),body:JSON.stringify({comment:t})}).then((function(e){if(!e.ok)throw new Error(e.statusText);x.dispatch({type:h,status:f})})).catch((function(e){x.dispatch(function(e){return{type:h,status:p,error:e}}(e))}))}var k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,isPosting:!1,comments:[],mostRecentGameId:null},t=arguments.length>1?arguments[1]:void 0;if(t.type===d){if(t.status===g){if(!e.isFetching)return O(t.gameId),Object.assign({},e,{isFetching:!0,fetchGameId:t.gameId,mostRecentGameId:t.gameId,error:""});if(t.gameId!==e.fetchGameId)return Object.assign({},e,{mostRecentGameId:t.gameId})}else if(t.status===p){if(e.isFetching)return Object.assign({},e,{isFetching:!1,fetchGameId:null,error:t.error})}else if(t.status===f&&e.isFetching)return e.fetchGameId===e.mostRecentGameId?Object.assign({},e,{isFetching:!1,comments:t.comments,commentsGameId:e.fetchGameId,fetchGameId:null,error:""}):(O(e.mostRecentGameId),Object.assign({},e,{fetchGameId:e.mostRecentGameId}))}else if(t.type===h)if(t.status===g){if(!e.isPosting&&!e.isFetching)return j(t.gameId,t.comment),Object.assign({},e,{isPosting:!0,error:""})}else if(t.status===p){if(e.isPosting)return Object.assign({},e,{isPosting:!1,error:t.error})}else if(t.status===f&&e.isPosting)return O(e.commentsGameId),Object.assign({},e,{isPosting:!1,isFetching:!0,mostRecentGameId:e.commentsGameId,error:""});return e},N=Object(s.b)({searchResults:v,game:w,comments:k}),x=Object(s.c)(N),F=(a(169),a(36)),P=a(40),_=(a(170),a(143)),R=a.n(_),I=a(157);a(171);var C=Object(i.b)(null,(function(e){return{fetchSearchResults:function(t){return e(b(t))}}}))((function(e){var t=Object(n.useState)(!1),a=Object(I.a)(t,2),c=a[0],l=a[1];function i(e){var t=e.target.id;e.target.checked&&("whitewin"!==t&&(document.getElementById("whitewin").checked=!1),"blackwin"!==t&&(document.getElementById("blackwin").checked=!1),"draw"!==t&&(document.getElementById("draw").checked=!1))}return r.a.createElement("form",{className:"search-box",onSubmit:function(t){t.preventDefault();var a=new FormData(t.target),n="";"on"===a.get("whitewin")?n="w":"on"===a.get("blackwin")?n="b":"on"===a.get("draw")&&(n="d");var r={playerw:a.get("whiteplayername"),playerb:a.get("blackplayername"),ignorecolors:"on"===a.get("ignorecolors"),winner:n,datemin:a.get("fromdate"),datemax:a.get("todate"),ratingmin:a.get("minrating"),ratingmax:a.get("maxrating"),eco:a.get("openingecocode"),turnmin:a.get("minturns"),turnmax:a.get("maxturns"),orderby:"id",descending:!1,offset:0,limit:25};e.fetchSearchResults(r)}},r.a.createElement("div",{className:"fieldset-flexbox"},r.a.createElement("fieldset",{className:"player"},r.a.createElement("legend",null,"Player names"),r.a.createElement("div",{className:"field-container"},r.a.createElement("label",{htmlFor:"whiteplayername"},c?"Player 1":"White Player"),r.a.createElement("input",{type:"text",name:"whiteplayername",id:"whiteplayername",placeholder:"User ID"})),r.a.createElement("div",{className:"field-container"},r.a.createElement("label",{htmlFor:"blackplayername"},c?"Player 2":"Black Player"),r.a.createElement("input",{type:"text",name:"blackplayername",id:"blackplayername",placeholder:"User ID"})),r.a.createElement("div",{className:"checkbox-container"},r.a.createElement("input",{type:"checkbox",name:"ignorecolors",id:"ignorecolors",onClick:function(e){l(e.target.checked)}}),r.a.createElement("label",{htmlFor:"ignorecolors"},"Ignore colors"))),r.a.createElement("fieldset",{className:"victory"},r.a.createElement("legend",null,"Winner"),r.a.createElement("div",{className:"checkbox-container"},r.a.createElement("input",{type:"checkbox",name:"whitewin",id:"whitewin",onClick:i}),r.a.createElement("label",{htmlFor:"whitewin"},"White")),r.a.createElement("div",{className:"checkbox-container"},r.a.createElement("input",{type:"checkbox",name:"blackwin",id:"blackwin",onClick:i}),r.a.createElement("label",{htmlFor:"blackwin"},"Black")),r.a.createElement("div",{className:"checkbox-container"},r.a.createElement("input",{type:"checkbox",name:"draw",id:"draw",onClick:i}),r.a.createElement("label",{htmlFor:"draw"},"Draw"))),r.a.createElement("fieldset",{className:"time"},r.a.createElement("legend",null,"Game time range"),r.a.createElement("div",{className:"field-container"},r.a.createElement("label",{htmlFor:"fromdate"},"From"),r.a.createElement("input",{type:"date",name:"fromdate",id:"fromdate"})),r.a.createElement("div",{className:"field-container"},r.a.createElement("label",{htmlFor:"todate"},"To"),r.a.createElement("input",{type:"date",name:"todate",id:"todate"}))),r.a.createElement("fieldset",{className:"ratings"},r.a.createElement("legend",null,"Player ratings"),r.a.createElement("div",{className:"field-container"},r.a.createElement("label",{htmlFor:"minrating"},"Min"),r.a.createElement("input",{type:"number",name:"minrating",id:"minrating"})),r.a.createElement("div",{className:"field-container"},r.a.createElement("label",{htmlFor:"maxrating"},"Max"),r.a.createElement("input",{type:"number",name:"maxrating",id:"maxrating"}))),r.a.createElement("fieldset",{className:"opening"},r.a.createElement("legend",null,"Opening"),r.a.createElement("div",{className:"field-container"},r.a.createElement("label",{htmlFor:"openingecocode"},"ECO code"),r.a.createElement("input",{type:"text",name:"openingecocode",id:"openingecode"}))),r.a.createElement("fieldset",{className:"turns"},r.a.createElement("legend",null,"Number of turns"),r.a.createElement("div",{className:"field-container"},r.a.createElement("label",{htmlFor:"minturns"},"Min"),r.a.createElement("input",{type:"number",name:"minturns",id:"minturns"})),r.a.createElement("div",{className:"field-container"},r.a.createElement("label",{htmlFor:"maxturns"},"Max"),r.a.createElement("input",{type:"number",name:"maxturns",id:"maxturns"})))),r.a.createElement("fieldset",{className:"submit"},r.a.createElement("button",{type:"submit"},"Search")))})),S=a(72),D=a(73),G=a(80),T=a(74),L=a(59),M=a(81);a(172);var B=function(e){var t=e.game,a=new Date(t.last_move_at);return r.a.createElement("tr",{className:"result-row",key:t.id},r.a.createElement("td",{className:"white-player-cell"},t.white_id),r.a.createElement("td",{className:"white-player-rating-cell"},t.white_rating),r.a.createElement("td",{className:"black-player-cell"},t.black_id),r.a.createElement("td",{className:"black-player-rating-cell"},t.black_rating),r.a.createElement("td",{className:"winner-cell"},t.winner),r.a.createElement("td",{className:"turns-cell"},t.turns),r.a.createElement("td",{className:"opening-cell"},t.opening_eco),r.a.createElement("td",{className:"increment-cell"},t.increment_code),r.a.createElement("td",{className:"time-cell"},a.toLocaleTimeString("en-GB",{hour12:!1})+" "+a.toLocaleDateString("en-GB")),r.a.createElement("td",{className:"more-info-cell"},r.a.createElement(F.b,{to:"/game/"+t.id},"Details \u2192")))};var H=function(e){var t=e.title,a=e.fieldName,n=e.paramObject,c=e.handleHeaderClick,l=t;return a===n.orderby&&(l+=" "+(n.descending?"\u25be":"\u25b4")),r.a.createElement("td",{className:"result-header-cell",onClick:function(){return c(a)}},l)},W=a(145),U=a.n(W),A=function(e){function t(e){var a;return Object(S.a)(this,t),(a=Object(G.a)(this,Object(T.a)(t).call(this,e))).handleHeaderClick=a.handleHeaderClick.bind(Object(L.a)(a)),a.handleScroll=a.handleScroll.bind(Object(L.a)(a)),a}return Object(M.a)(t,e),Object(D.a)(t,[{key:"handleHeaderClick",value:function(e){if(0!==Object.keys(this.props.mostRecentParamObject).length){var t=Object.assign({},this.props.mostRecentParamObject,{offset:0,limit:25});this.props.mostRecentParamObject.orderby===e?t.descending=!t.descending:(t.orderby=e,t.descending=!1),this.props.fetchSearchResults(t)}}},{key:"handleScroll",value:function(){var e=document.documentElement;window.innerHeight+window.scrollY<e.scrollHeight-150||this.props.fetchMoreSearchResults(25)}},{key:"componentDidMount",value:function(){window.addEventListener("scroll",this.handleScroll)}},{key:"render",value:function(){var e=this;return r.a.createElement("table",{className:"result-box"},r.a.createElement("thead",{className:"result-box-header"},r.a.createElement("tr",null,[["White Player","white_id"],["Rating","white_rating"],["Black Player","black_id"],["Rating","black_rating"],["Winner","winner"],["Turns","turns"],["Opening","opening_eco"],["Increment","increment_code"],["Time","last_move_at"]].map((function(t){return r.a.createElement(H,{key:t[1],title:t[0],fieldName:t[1],paramObject:e.props.mostRecentParamObject,handleHeaderClick:e.handleHeaderClick})})))),r.a.createElement("tbody",null,this.props.results.map((function(e){return r.a.createElement(B,{game:e,key:e.id})})),r.a.createElement("tr",null,r.a.createElement("td",{className:"loading-symbol-cell",colSpan:"10"},this.props.isFetching?r.a.createElement("img",{src:U.a,alt:"Loading"}):null))))}}]),t}(n.Component);var J=Object(i.b)((function(e){return{isFetching:e.searchResults.isFetching,mostRecentParamObject:Object.assign({},e.searchResults.mostRecentParamObject),results:e.searchResults.results}}),(function(e){return{fetchSearchResults:function(t){return e(b(t))},fetchMoreSearchResults:function(t){return e(function(e){return{type:u,status:g,limit:e}}(t))}}}))(A),Q=a(286),V=a(287),Y=a(284),$=a(288);var q=Object(i.b)((function(e){return{graphData:e.searchResults.graphData}}))((function(e){return void 0===e.graphData?r.a.createElement("div",null):r.a.createElement(Q.a,{domainPadding:{x:10},padding:{left:100,right:100,bottom:50,top:40},height:150,standalone:!0},r.a.createElement(V.a,{text:"Distribution of player rankings",x:225,y:30,textAnchor:"middle",style:{fill:"orange"}}),r.a.createElement(Y.a,{style:{data:{fill:"#c43a31"}},data:e.graphData,x:"Rating",y:"sum(Instance)"}),r.a.createElement($.a,{label:"Rating",style:{axisLabel:{fill:"orange"},tickLabels:{fill:"white"}},fixLabelOverlap:!0}),r.a.createElement($.a,{dependentAxis:!0,label:"Instances",axisLabelComponent:r.a.createElement(V.a,{x:50}),style:{axisLabel:{fill:"orange"},tickLabels:{fill:"white"}},fixLabelOverlap:!0}))}));var z=function(){return r.a.createElement("div",{className:"searchpage"},r.a.createElement("header",{className:"searchpage-header"},r.a.createElement("h1",null,"Chess Search")),r.a.createElement("section",{className:"searchpage-section"},r.a.createElement("img",{src:R.a,className:"image-chess",alt:"white chess knight"}),r.a.createElement(C,null),r.a.createElement(q,null),r.a.createElement(J,null)),r.a.createElement("footer",{className:"searchpage-footer"},r.a.createElement("div",null,"Loading icon made by"," ",r.a.createElement("a",{href:"https://www.flaticon.com/authors/roundicons",title:"Roundicons",target:"_blank",rel:"noopener noreferrer"},"Roundicons")," ","from"," ",r.a.createElement("a",{href:"https://www.flaticon.com/",title:"Flaticon",target:"_blank",rel:"noopener noreferrer"},"www.flaticon.com"))))},K=(a(275),a(79)),X=a.n(K);var Z=function(e){var t=e.comments;return r.a.createElement("div",{className:"comment-list"},t.map((function(e,t){return r.a.createElement("div",{key:e.CommentID},r.a.createElement("h3",{key:e.CommentID+"date"},new Date(e.DateTime).toLocaleString("en-GB",{hour12:!1})),r.a.createElement("p",{key:e.CommentID+"comment"},e.Comment))})))};var ee=function(e){var t=e.gameId,a=(e.isPosting,e.postComment);return r.a.createElement("form",{className:"comment-entry",id:"comment-entry",onSubmit:function(e){e.preventDefault();var n=new FormData(e.target);""!==n.get("comment")&&(a(t,n.get("comment")),e.target.reset())}},r.a.createElement("legend",null,"Comment Entry"),r.a.createElement("fieldset",{className:"comment-textarea-fieldset"},r.a.createElement("textarea",{className:"comment-textarea",name:"comment",form:"comment-entry",rows:"4",cols:"50"})),r.a.createElement("fieldset",{className:"comment-submit-fieldset"},r.a.createElement("button",{className:"comment-submit",type:"submit"},"Post comment")))},te=(a(276),function(e){function t(){return Object(S.a)(this,t),Object(G.a)(this,Object(T.a)(t).apply(this,arguments))}return Object(M.a)(t,e),Object(D.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchComments(this.props.gameId)}},{key:"render",value:function(){return r.a.createElement("div",{className:"comment-box"},r.a.createElement(ee,{gameId:this.props.gameId,postComment:this.props.postComment}),r.a.createElement(Z,{comments:this.props.comments}))}}]),t}(n.Component));var ae=Object(i.b)((function(e,t){return{comments:e.comments.comments,gameId:t.id}}),(function(e){return{fetchComments:function(t){return e(function(e){return{type:d,status:g,gameId:e}}(t))},postComment:function(t,a){return e(function(e,t){return{type:h,status:g,gameId:e,comment:t}}(t,a))}}}))(te);var ne=Object(i.b)((function(e,t){return{game:e.game.data,match:t.match}}),(function(e){return{fetchGame:function(t){return e(function(e){return{type:o,status:g,id:e}}(t))}}}))((function(e){var t=e.game,a=e.match,n=e.fetchGame,c=a.params.id;t&&t.id===c||(n(c),t={black_id:null,black_rating:null,created_at:null,id:null,increment_code:null,last_move_at:null,moves:null,opening_eco:null,opening_name:null,opening_ply:null,rated:null,turns:null,victory_status:null,white_id:null,white_rating:null,winner:null});var l=new Date(t.created_at),i=new Date(t.last_move_at),s=(i-l)/6e4,m=r.a.createElement("font",{color:"yellow"},"winner"),o=t.moves?t.moves.split(" "):null,u=[];if(o){for(var d=1;2*d-1<o.length;d++)u.push(d.toString()+". "+o[2*d-2]+" "+o[2*d-1]);o.length%2===1&&u.push(((o.length+1)/2).toString()+". "+o[o.length-1])}return r.a.createElement("div",{className:"gamepage"},r.a.createElement("header",{className:"gamepage-header"},r.a.createElement(F.b,{className:"home",to:"/"},r.a.createElement("img",{src:X.a,className:"search",alt:"white chess knight"})),r.a.createElement("h2",null,"Detailed Game Information")),r.a.createElement("section",{className:"gamepage-section"},r.a.createElement("div",{className:"gamepage-section-text"},r.a.createElement("p",null,r.a.createElement("b",null,"White Player: "),t.white_id," ","white"===t.winner?m:""),r.a.createElement("p",null,r.a.createElement("b",null,"Black Player: "),t.black_id," ","black"===t.winner?m:""),r.a.createElement("p",null,r.a.createElement("b",null,"Date: "),l.toLocaleDateString("en-GB")),r.a.createElement("p",null,r.a.createElement("b",null,"Started at: ")," ",l.toLocaleTimeString("en-GB",{hour12:!1})),r.a.createElement("p",null,r.a.createElement("b",null,"Ended at: ")," ",i.toLocaleTimeString("en-GB",{hour12:!1})),r.a.createElement("p",null,r.a.createElement("b",null,"Duration: "),Math.round(s)," minutes"),r.a.createElement("p",null,r.a.createElement("b",null,"Ratings: "),r.a.createElement("font",{color:"yellow"},t.white_rating),"(white)"," ",r.a.createElement("font",{color:"yellow"},t.black_rating),"(black)"),r.a.createElement("p",null,r.a.createElement("b",null,"Turns: "),t.turns),r.a.createElement("p",null,r.a.createElement("b",null,"Opening: "),r.a.createElement("font",{color:"yellow"},t.opening_eco)," - ",t.opening_name),r.a.createElement("p",null,r.a.createElement("b",null,"Opening Plies: "),t.opening_ply),r.a.createElement("p",null,r.a.createElement("b",null,"Victory Status: "),t.victory_status)),r.a.createElement("div",{className:"gamepage-section-moves"},r.a.createElement("div",{className:"gamepage-section-moves-h"},r.a.createElement("b",null,"Moves:")),r.a.createElement("div",{className:"gamepage-section-moves-t"},u.map((function(e,t){return r.a.createElement("div",{className:"gamepage-section-moves-move",key:t},e)})))),r.a.createElement(ae,{id:c})),r.a.createElement("footer",{className:"gamepage-footer"}))}));a(277);var re=function(){return r.a.createElement("div",{className:"error"},r.a.createElement(F.b,{className:"search",to:"/"},r.a.createElement("img",{src:X.a,alt:"white chess knight"})),r.a.createElement("p",{className:"error-p"},"Page not found"))},ce=function(){return r.a.createElement("div",{className:"app"},r.a.createElement(F.a,null,r.a.createElement(P.c,null,r.a.createElement(P.a,{exact:!0,path:"/",component:z}),r.a.createElement(P.a,{exact:!0,path:"/game/:id",component:ne}),r.a.createElement(P.a,{component:re}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));window.store=x,l.a.render(r.a.createElement(i.a,{store:x}," ",r.a.createElement(ce,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},79:function(e,t,a){e.exports=a.p+"static/media/search.aa327644.svg"}},[[159,1,2]]]);
//# sourceMappingURL=main.c2833c1f.chunk.js.map